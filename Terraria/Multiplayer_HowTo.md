# 如何在电脑上创建PE服务器并让好友加入

> [官方链](https://forums.terraria.org/index.php?threads/terraria-mobile-1-3-multiplayer-setup-guide.82210/)

大扎好，我是“[这个人](http://tieba.baidu.com/home/main?un=Moore940)”，由于度娘想气死我，我所以我把贴子搬到了这里。  
有疑问建议在发布这篇文章的贴子里提出。  
目录如下:  

- [创建一个服务器](#创建一个服务器)  
- - [创建世界](#创建世界)  
- - [选择世界](#选择世界)  
- [伪端口映射](#伪端口映射)  

> 这篇教程**针对`Windows`平台**（太远古的版本估计也不行）  

> 截至发布，官方未给出其它平台的服务端  
> 不过NGROK是跨平台的哟  

## 创建一个服务器

需要准备的东西：  

- 一台电脑
- - 需求：安装有[`.NET Framework`](https://www.microsoft.com/en-us/download/details.aspx?id=17851) 4.0 和[`XNA Framework`](https://www.microsoft.com/en-us/download/details.aspx?id=20914) 4.0
- - - 进入下载链后点击最显眼的`Download`字样即可，大部分电脑自带.NET
- [Terraria Mobile的服务端](https://forums.terraria.org/index.php?attachments/terrariaserver-zip.225967/)  
- - [站内链](./RequiredFiles/TerrariaServer.zip)  

> **服务端并不是本人作品**  

服务端是一个压缩包，解压后含有以下文件：

|类型|名字|
|:--:|:--:|
|文件夹|Localisation|
|文件|TerrariaServer.exe|

双击`TerrariaServer.exe`，它的界面如下：  

![界面](./Pictures/1.png '其实你们一开始应该没有世界')  

### 创建世界

> [点此跳过这步](#选择世界)

各位一开始应该是没有建立世界的，我们需要建立一个新的世界（废话），按下键盘上的N和Enter，去到下一个界面。  

![界面](./Pictures/2.png '按下N和Enter后')  

这是叫输入一个1-3之间的数值来决定世界尺寸。数值对应的尺寸如下：  

|数值|尺寸|
|:-:|:-:|
|1|小|
|2|中|
|3|大|  

想要知道世界具体有多大的请上维基。我们进入下一步，按下键盘上的3和Enter。  

![界面](./Pictures/3.png '按下3和Enter后')  

选择世界难度，不了解难度的还是请上维基。  

|数值|难度|
|:-:|:-:|
|1|普通|
|2|专家|  

按下键盘上的2和Enter后我们进入下一步。  

![界面](./Pictures/4.png '按下2和Enter后')  

这一步是要输入世界名，建议全英文。  

输入“Hello World”后按下键盘上的回车。  

![界面](./Pictures/5.png '按下Enter后')  

此时世界正在创建，应该等待一段时间，过一会后会显示创建进度。 

世界创建完毕后如图：

![界面](./Pictures/6.png '世界创建完毕')  

### 选择世界

> 下次想要继续玩旧地图也是从这一步开始。  
  
可以看到世界名前面有个序号，刚才创建的世界的名字是“Hello World”，它前面的序号是1，所以我们选1，即按下1然后Enter。  

> 以下操作什么都不填直接按回车是选择括号里的默认值  

![界面](./Pictures/7.png '之后')  

写玩家人数，可以写大点。虽然PE上限是16，但是这里是可以填比16还大的数值的。  

我输入99然后回车。  

![界面](./Pictures/8.png '之后')  

叫填端口（一个0-65535之间的值，可以自己填，推荐别乱填）。回车就好，后面称它为`端口A`。如果没填，它就是7777；填了，就是你填的数字。

![界面](./Pictures/9.png '之后')  

是否自动转发端口的选项，y是“是”，n是“否”，似乎随便填？（但我没填过n）  

输入y然后回车。  

![界面](./Pictures/10.png '之后')  

服务器密码，没什么好说的，直接回车=没密码，有密码也建议全英文。

回车后会经历以下两个阶段：  

![界面](./Pictures/11.png '加载中')  

![界面](./Pictures/12.png '服务器已准备完成')  

到了第二张图片后，服务器就已经开启了，可以在同一Wi-Fi上的手机上搜到服务器（如图）。  

![界面](./Pictures/13.png '第一个')  

想进去看看的话可以直接加入，或者直接进入下一步，搜索不到服务器也可以用下一步的方法进入。  

想要关闭服务器就在上面的窗口上输入`exit`并回车，直接点叉叉可能会回挡。

## 伪端口映射

> 能够端口映射的同学，建议建立一个`外网IP`:`任意端口`->`你电脑的局域网IP`:`端口A`的映射，NGROK资源宝贵  
  此时好友通过`你的外网IP`:`刚才提及的某个端口`即可加入游戏  

缺点摆在前：**无法BAN人**。

需要的工具：

- [NGROK](https://github.com/inconshreveable/ngrok)（*非本人作品，链接指向作品页面*）
- 我制作好的批处理

上面两个我放在一起了，[下载点这](./RequiredFiles/ngrok.zip)。

解压后的文件：  

|类型|名字|
|:--:|:--:|
|文件|ngrok.exe|
|文件|ITTUN.bat|  

> 感谢NGROK服务器[ITTUN](http://www.ittun.com)的拥有者的贡献  

双击`ITTUN.bat`，会遇到这个界面：  

![界面](./Pictures/14.png '界面')  

~~瞎造名词勿吐槽。~~  

输入一个50000-65535的数值，我个人经常用51234，建议别用我的数值啊。把该数值记下，作为`端口B`，然后回车。  

![界面](./Pictures/15.png '界面')  

输入`端口A`然后回车。**不知道端口A的请往上翻**。

![界面](./Pictures/16.png '界面')  

如果你遇到了红色的字、窗口闪退等问题，建议换个端口 ~~，实在不行就等死8~~。  

这时候，你或你的好友就能通过  

|IP|端口|
|:-:|:-:|
|`tcp.ittun.com`|`端口B`|  

加入游戏了，不用此软件时建议关闭，**NGROK资源宝贵**。  

> 如果自己手机能用局域网连建议不要用输入IP的方法连，否则延迟会变大  

> 认知以外：用手机搜索不到服务器者可以尝试把自动转发端口关闭
